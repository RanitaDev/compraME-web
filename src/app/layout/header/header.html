@if (1 >= 1) {
  <div class="w-full h-auto flex justify-between items-center pt-4 pb-2">
  <div class="logo">
    <span class="font-bold text-xl text-gray-800 cursor-pointer" (click)="goHome()">CompraME!</span>
  </div>

  <div class="flex items-center flex-1 justify-end">
    <!-- Search Component -->
    <div class="search-container group relative flex items-center">
      <div class="flex items-center h-9 bg-white group-hover:bg-[#e4f6ff] rounded-full transition-all duration-300
                  ease-in-out overflow-hidden group-hover:w-[calc(75vw-320px)] w-9 border border-white group-hover:border-[#527280]/30">
        <div class="flex items-center justify-center w-8.5 h-9 flex-shrink-0">
          <i class="pi pi-search text-[#3f5963] text-lg"></i>
        </div>
        <input
          type="text"
          placeholder="Buscar productos..."
          class="flex-1 bg-transparent border-none outline-none px-3 text-[#527280] placeholder-[#527280]/40 opacity-0
                group-hover:opacity-100 transition-opacity duration-350 ease-in-out"
        />
      </div>
    </div>

    <div class="flex items-center gap-2">
      <p-button
        icon="pi pi-shopping-cart text-gray-700"
        rounded
        text
        severity="info"
        styleClass="w-12 h-12"
        (onClick)="abrirCarrito()"
      ></p-button>

      <!-- Usuario autenticado -->
      @if (isAuthenticated && currentUser) {
        <div class="user-section flex items-center gap-3">
          <!-- Saludo con nombre -->
          <span class="text-sm text-gray-600 hidden sm:inline">
            ¡Hola, {{ currentUser.nombre }}!
          </span>

          <!-- Avatar con iniciales o menú desplegable -->
          <div class="relative group">
            <p-avatar
              [label]="getUserInitials()"
              class="w-12 h-12 cursor-pointer bg-blue-100 text-blue-600"
              shape="circle"
              (click)="goToProfile()"
              [pTooltip]="getUserDisplayName()"
              tooltipPosition="bottom">
            </p-avatar>

            <!-- Mini menú desplegable -->
            <div class="absolute right-0 top-full mt-2 w-48 bg-white rounded-lg shadow-lg border opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50">
              <div class="p-3 border-b">
                <p class="font-medium text-sm text-gray-900">{{ getUserDisplayName() }}</p>
                <p class="text-xs text-gray-500">{{ currentUser.email }}</p>
                @if (currentUser.telefono) {
                  <p class="text-xs text-gray-500">{{ currentUser.telefono }}</p>
                }
              </div>
              <div class="p-2">
                <button
                  (click)="goToProfile()"
                  class="w-full text-left px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded transition-colors">
                  <i class="pi pi-user mr-2"></i>
                  Mi Perfil
                </button>
                <button
                  (click)="logout()"
                  class="w-full text-left px-3 py-2 text-sm text-red-600 hover:bg-red-50 rounded transition-colors">
                  <i class="pi pi-sign-out mr-2"></i>
                  Cerrar Sesión
                </button>
              </div>
            </div>
          </div>
        </div>
      }
      <!-- Usuario no autenticado -->
      @else {
        <div class="auth-section flex items-center gap-2">
          <p-avatar
            icon="pi pi-user text-gray-400"
            class="w-12 h-12 cursor-pointer"
            shape="circle"
            (click)="goToLogin()"
            />
        </div>
      }
    </div>
  </div>
</div>
<div class="border-b border-gray-300"></div>

<app-cart-modal
  (modalClosed)="modalCarritoCerrada()"
  (checkoutRequested)="onCheckout()">
</app-cart-modal>

}
