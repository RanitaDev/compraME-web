<div class="min-h-screen flex items-center justify-center bg-gray-50 px-4">
  <div class="bg-white rounded-lg border border-gray-200 p-8 w-full relative overflow-hidden"
       [class.max-w-md]="isLoginMode()"
       [class.max-w-2xl]="!isLoginMode()">
    <!-- ENCABEZADO -->
    <div class="text-center mb-6">
      <h1 class="text-2xl font-semibold text-gray-900 mb-2">
        {{ isLoginMode() ? 'Bienvenido de nuevo' : 'Crear cuenta' }}
      </h1>
      <p class="text-gray-600 text-sm">
        {{ isLoginMode() ? 'Inicia sesión en tu cuenta' : 'Únete a nuestra comunidad' }}
      </p>
    </div>

    <!-- FORMULARIO DE INICIO DE SESIÓN -->
    <form *ngIf="isLoginMode()" [formGroup]="loginForm" (ngSubmit)="onLogin()" class="space-y-4">
      <!-- CAMPO DE EMAIL -->
      <div class="form-group">
        <label for="loginEmail" class="block text-sm font-medium text-gray-700 mb-1">Correo electrónico</label>
        <div class="input-wrapper"
             [pTooltip]="loginForm.get('email')?.invalid && loginForm.get('email')?.touched ? 'Ingresa un email válido' : ''"
             tooltipPosition="top"
             [tooltipOptions]="{showDelay: 0, hideDelay: 0, tooltipStyleClass: 'error-tooltip'}">
            <input
              pInputText
              id="loginEmail"
              type="email"
              formControlName="email"
              placeholder="tu@email.com"
              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"
              [class.border-red-300]="loginForm.get('email')?.invalid && loginForm.get('email')?.touched"
              autocomplete="username"
            />
        </div>
      </div>

      <!-- CAMPO DE CONTRASEÑA -->
      <div class="form-group">
        <label for="loginPassword" class="block text-sm font-medium text-gray-700 mb-1">Contraseña</label>
        <div class="input-wrapper"
          [pTooltip]="loginForm.get('password')?.invalid && loginForm.get('password')?.touched ? 'La contraseña debe tener al menos 6 caracteres' : ''"
          tooltipPosition="top"
             [tooltipOptions]="{showDelay: 0, hideDelay: 0, tooltipStyleClass: 'error-tooltip'}">
          <p-password
            formControlName="password"
            placeholder="••••••••"
            styleClass="w-full"
            inputStyleClass="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"
            [class.border-red-300]="loginForm.get('password')?.invalid && loginForm.get('password')?.touched"
            [feedback]="false"
            [toggleMask]="true">
          </p-password>
        </div>
      </div>

      <!-- OPCIONES DE FORMULARIO -->
      <div class="flex items-center justify-between">
        <div class="flex items-center gap-2">
            <p-checkbox
              formControlName="rememberMe"
              inputId="rememberMe"
              styleClass="align-middle"
              [ngStyle]="{
                '--p-checkbox-background': 'white',
                '--p-checkbox-hover-border-color': '#3b82f6',
                '--p-checkbox-checked-background': '#3b82f6',
                '--p-checkbox-checked-hover-background': '#2563eb',
                '--p-checkbox-icon-color': 'white',
                '--p-checkbox-icon-checked-color': 'white',
                '--p-checkbox-checked-border-color': '#3b82f6',
                '--p-checkbox-checked-hover-border-color': '#2563eb',
                '--p-checkbox-icon-checked-hover-color': 'white'
              }"
              binary="true"
              [size]="'small'"
              >
          </p-checkbox>
          <label
            for="rememberMe"
            class="text-sm text-gray-600 cursor-pointer select-none"
            (click)="loginForm.get('rememberMe')?.setValue(!loginForm.get('rememberMe')?.value)">
            Recordar usuario
          </label>
        </div>
        <a href="#" class="text-sm text-blue-600 hover:text-blue-700 hover:underline">¿Olvidaste tu contraseña?</a>
      </div>

      <!-- BOTÓN DE INICIO DE SESIÓN -->
      <div class="pt-2">
        <p-button
          type="submit"
          label="Iniciar Sesión"
          styleClass="auth-button primary w-full"
          icon="pi pi-sign-in"
          [disabled]="loginForm.invalid">
        </p-button>
      </div>

      <!-- DIVIDER Y BOTONES SOCIALES -->
      <p-divider align="center" styleClass="auth-divider my-4">
        <span class="text-gray-500 text-sm px-3">o inicia con</span>
      </p-divider>

      <div class="grid grid-cols-2 gap-3">
        <p-button
          type="button"
          label="Google"
          icon="pi pi-google"
          styleClass="auth-button social google w-full">
        </p-button>
        <p-button
          type="button"
          label="Facebook"
          icon="pi pi-facebook"
          styleClass="auth-button social facebook w-full">
        </p-button>
      </div>
    </form>

    <!-- FORMULARIO DE REGISTRO -->
    <form *ngIf="!isLoginMode()" [formGroup]="registerForm" (ngSubmit)="onRegister()" class="space-y-4">

      <!-- FILA 1: Nombre y Apellido -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div class="form-group">
          <label for="firstName" class="block text-sm font-medium text-gray-700 mb-1">Nombre</label>
          <div class="input-wrapper w-full"
               [pTooltip]="registerForm.get('firstName')?.invalid && registerForm.get('firstName')?.touched ? 'Nombre requerido' : ''"
               tooltipPosition="top"
               [tooltipOptions]="{showDelay: 0, hideDelay: 0, tooltipStyleClass: 'error-tooltip'}">
            <input
              pInputText
              id="firstName"
              type="text"
              formControlName="firstName"
              placeholder="Juan"
              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"
              [class.border-red-300]="registerForm.get('firstName')?.invalid && registerForm.get('firstName')?.touched"
            />
          </div>
        </div>

        <div class="form-group">
          <label for="lastName" class="block text-sm font-medium text-gray-700 mb-1">Apellido</label>
          <div class="input-wrapper"
               [pTooltip]="registerForm.get('lastName')?.invalid && registerForm.get('lastName')?.touched ? 'Apellido requerido' : ''"
               tooltipPosition="top"
               [tooltipOptions]="{showDelay: 0, hideDelay: 0, tooltipStyleClass: 'error-tooltip'}">
            <input
              pInputText
              id="lastName"
              type="text"
              formControlName="lastName"
              placeholder="Pérez"
              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"
              [class.border-red-300]="registerForm.get('lastName')?.invalid && registerForm.get('lastName')?.touched"
            />
          </div>
        </div>
      </div>

      <!-- FILA 2: Email y Teléfono -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div class="form-group">
          <label for="registerEmail" class="block text-sm font-medium text-gray-700 mb-1">Correo electrónico</label>
          <input
            pInputText
            id="registerEmail"
            type="email"
            formControlName="email"
            placeholder="tu@email.com"
            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"
            [class.border-red-300]="registerForm.get('email')?.invalid && registerForm.get('email')?.touched"
          />
          <small
            *ngIf="registerForm.get('email')?.invalid && registerForm.get('email')?.touched"
            class="text-red-600 text-xs mt-1 block">
            Ingresa un email válido
          </small>
        </div>

        <div class="form-group">
          <label for="registerPhone" class="block text-sm font-medium text-gray-700 mb-1">Teléfono</label>
          <input
            pInputText
            id="registerPhone"
            type="tel"
            formControlName="telefono"
            placeholder="12345678"
            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"
            [class.border-red-300]="registerForm.get('telefono')?.invalid && registerForm.get('telefono')?.touched"
          />
          <small
            *ngIf="registerForm.get('telefono')?.invalid && registerForm.get('telefono')?.touched"
            class="text-red-600 text-xs mt-1 block">
            El teléfono debe tener entre 8 y 15 dígitos
          </small>
        </div>
      </div>

      <!-- FILA 3: Contraseñas -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div class="form-group">
          <label for="registerPassword" class="block text-sm font-medium text-gray-700 mb-1">Contraseña</label>
          <p-password
            formControlName="password"
            placeholder="••••••••"
            styleClass="w-full"
            inputStyleClass="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"
            [class.border-red-300]="registerForm.get('password')?.invalid && registerForm.get('password')?.touched"
            [feedback]="true"
            [toggleMask]="true">
          </p-password>
          <small
            *ngIf="registerForm.get('password')?.invalid && registerForm.get('password')?.touched"
            class="text-red-600 text-xs mt-1 block">
            La contraseña debe tener entre 6 y 32 caracteres
          </small>
        </div>

        <div class="form-group">
          <label for="confirmPassword" class="block text-sm font-medium text-gray-700 mb-1">Confirmar contraseña</label>
          <p-password
            formControlName="confirmPassword"
            placeholder="••••••••"
            styleClass="w-full"
            inputStyleClass="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"
            [class.border-red-300]="registerForm.get('confirmPassword')?.invalid && registerForm.get('confirmPassword')?.touched"
            [feedback]="false"
            [toggleMask]="true">
          </p-password>
          <small
            *ngIf="registerForm.get('confirmPassword')?.invalid && registerForm.get('confirmPassword')?.touched"
            class="text-red-600 text-xs mt-1 block">
            Las contraseñas no coinciden
          </small>
        </div>
      </div>

      <!-- BOTÓN DE REGISTRO -->
      <div class="pt-4">
        <p-button
          type="submit"
          label="Crear Cuenta"
          styleClass="auth-button primary w-full">
        </p-button>
      </div>

      <!-- DIVIDER Y BOTONES SOCIALES -->
      <p-divider align="center" styleClass="auth-divider my-4">
        <span class="text-gray-500 text-sm px-3">o regístrate con</span>
      </p-divider>

      <div class="grid grid-cols-2 gap-3">
        <p-button
          type="button"
          label="Google"
          icon="pi pi-google"
          styleClass="auth-button social google w-full">
        </p-button>
        <p-button
          type="button"
          label="Facebook"
          icon="pi pi-facebook"
          styleClass="auth-button social facebook w-full">
        </p-button>
      </div>
    </form>

    <!-- CAMBIO A INICIAR SESIÓN/REGISTRO -->
    <div class="text-center mt-6 pt-4 border-t border-gray-200">
      <p class="text-gray-600 text-sm">
        {{ isLoginMode() ? '¿No tienes una cuenta?' : '¿Ya tienes una cuenta?' }}
        <p-button
          label="{{ isLoginMode() ? 'Regístrate' : 'Inicia sesión' }}"
          (click)="toggleMode()"
          size="small"
          text="true"
          severity="info"
        ></p-button>
      </p>
    </div>
  </div>
</div>
